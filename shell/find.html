---
layout: lesson
title: Finding Things
lesson_title: The Unix Shell
prev: shell/perm.html
next: shell/job.html
uplink: shell/index.html
pdf: v4/shell/find.pdf
ppt: v4/shell/find.ppt
youtube: {"slug": "7uZW1Fh8JLY", "time": "00:09:22.52"}
---
<ul class="keypoints">
  <li>Use grep to match text in a file or files.</li>
  <li>grep can also match patterns specified by a code called a regular expression.</li>
  <li>Use find to identify files whose names match a given pattern.</li>
  <li>Both grep and find have extensive options available through flags.</li>
</ul>

<div class="transcript">
  <div class="media">
    <img class="media-object pull-left" src="find/001.png" />
    <p class="media-body">Hello, and welcome to the sixth episode of the Software Carpentry lecture on the Unix shell.  This short episode will show you how to find things in files, and how to find files themselves.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/002.png" />
    <p class="media-body">We're looking at how to interact with a computer using a command-line shell.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/003.png" />
    <p class="media-body">Listening to how people talk about search, you can often guess their age.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/004.png" />
    <p class="media-body">Just as young people use "Google" as a verb&hellip;</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/005.png" />
    <p class="media-body">&hellip;crusty old Unix programmers use the word "grep".</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/006.png" />
    <p class="media-body">"grep" is a contraction of "global/regular expression/print", which was a common sequence of operations in early Unix text editors.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/007.png" />
    <p class="media-body">What the <code>grep</code> program does is find and print lines in files that match a pattern.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/008.png" />
    <p class="media-body">Here's the file we'll use for our examples.  It contains three computer haikus taken from a <a href="http://www.salonmagazine.com/21st/chal/1998/01/26chal.html">competition</a> that <a href="http://www.salon.com"><cite>Salon</cite></a> magazine ran in 1998.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/009.png" />
    <p class="media-body">Let's run the command <code>grep not haiku.txt</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/010.png" />
    <p class="media-body">Here, "not" is the pattern we're searching for.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/011.png" />
    <p class="media-body">It's a pretty simple pattern: every alphanumeric character matches against itself.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/012.png" />
    <p class="media-body">After the pattern comes the name or names of the files we're searching in.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/013.png" />
    <p class="media-body">As you can see, the output is the three lines in the file that contain the letters "not".</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/014.png" />
    <p class="media-body">Let's try a different pattern: "day".  This time, the output is lines containing the words "Yesterday" and "Today", which both have the letters "day".</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/015.png" />
    <p class="media-body">If we give <code>grep</code> the <code>-w</code> flag, it restricts matches to word boundaries, so that only lines with the word "day" will be printed, not lines with "Today" or "daytime".  In this case, there aren't any, so <code>grep</code>'s output is empty.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/016.png" />
    <p class="media-body">Another useful option is <code>-n</code>, which numbers the lines that match.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/017.png" />
    <p class="media-body">Here, we can see that lines 5, 9, and 10 in the file contain the word "it" (or a word that contains "it").</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/018.png" />
    <p class="media-body">As with other Unix commands, we can combine flags&hellip;</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/019.png" />
    <p class="media-body">&hellip;to get only whole-word matches, with line numbers.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/020.png" />
    <p class="media-body">Here's another example.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/021.png" />
    <p class="media-body"><code>-i</code> makes matching case-insensitive&hellip;</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/022.png" />
    <p class="media-body">&hellip;while <code>-v</code> inverts the match, so that it only prints lines that <em>don't</em> match the pattern.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/023.png" />
    <p class="media-body"><code>grep</code> has lots and lots of options.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/024.png" />
    <p class="media-body">To find out what they are, we can type <code>man grep</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/025.png" />
    <p class="media-body"><code>man</code> is the Unix "manual" command; it prints a description of a command and its options, and (if you're lucky) provides a few examples of how to use it.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/026.png" />
    <p class="media-body"><code>grep</code>'s real power doesn't come from its options, though; it comes from the fact that its patterns can be <em>regular expressions</em>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/027.png" />
    <p class="media-body">(That's what the "re" in "grep" stands for.)</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/028.png" />
    <p class="media-body">Regular expressions are complex enough that we've devoted an entire lecture to them; if you want to do complex searches, please take a few minutes to watch its first few episodes.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/029.png" />
    <p class="media-body">One caution: <code>grep</code>'s regular expressions use a slightly different syntax than what's used in most programming languages.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/030.png" />
    <p class="media-body">However, the basic ideas and rules are exactly the same.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/031.png" />
    <p class="media-body">While <code>grep</code> finds lines in files, the <code>find</code> command finds files themselves.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/032.png" />
    <p class="media-body">Again, it has a lot of options&mdash;too many to cover here.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/033.png" />
    <p class="media-body">To show how its basic features work, we'll use this directory tree.  Under Vlad's home directory is one file, <code>notes.txt</code>, and three subdirectories: <code>thesis</code> (which is sadly empty), <code>data</code> (which contains two files <code>first.txt</code> and <code>second.txt</code>), and a <code>tools</code> directory that contains the programs <code>format</code> and <code>stats</code>, and an empty subdirectory called <code>old</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/034.png" />
    <p class="media-body">Here's a textual representation of that same tree, created using the Unix <code>tree</code> command.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/035.png" />
    <p class="media-body">As with <code>ls -F</code>, trailing <code>/</code>'s show directories&hellip;</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/036.png" />
    <p class="media-body">&hellip;and trailing <code>*</code>'s show files we could run as programs.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/037.png" />
    <p class="media-body">For our first command, let's run <code>find . -type d</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/038.png" />
    <p class="media-body">Here, <code>.</code> is the root directory of our search: <code>find</code> will only look in it, and the things it contains.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/039.png" />
    <p class="media-body"><code>-type d</code> means "things that are directories".</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/040.png" />
    <p class="media-body">Sure enough, <code>find</code>'s output is the names of the five directories in our little tree (including <code>.</code>, the current working directory).</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/041.png" />
    <p class="media-body">If we change <code>-type d</code> to <code>-type f</code>, we get a listing of all the files instead.  <code>find</code> automatically goes into subdirectories, their subdirectories, and so on to find everything that matches the pattern we've given it.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/042.png" />
    <p class="media-body">If we don't want to go that deep, we can use <code>-maxdepth</code> to restrict the depth of search.  Here, <code>-maxdepth 1</code> tells <code>find</code> to only look at this level, so the only file it finds is <code>./notes.txt</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/043.png" />
    <p class="media-body">The opposite of <code>-maxdepth</code> is <code>-mindepth</code>, which tells <code>find</code> to only report things that are at or below a certain depth.  <code>-mindepth 2</code> therefore finds all the files that are two or more levels below us.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/044.png" />
    <p class="media-body">And here's another option: <code>-empty</code>.  This restricts matching to empty files and directories, of which we have two.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/045.png" />
    <p class="media-body">We can search by permissions, too.  Here, for example, we can use <code>-perm -u=x</code> to find both files and directories for which the user has 'x' permission.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/046.png" />
    <p class="media-body">Combine this with <code>-type f</code> to exclude directories, and voila: a list of runnable program files.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/047.png" />
    <p class="media-body">Let's try matching by name with <code>find . -name *.txt</code>.  We expect it to find all the text files, but it only prints out <code>./notes.txt</code>.  What's gone wrong?</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/048.png" />
    <p class="media-body">If you recall, the shell expands wildcard characters like <code>*</code> <em>before</em> commands run.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/049.png" />
    <p class="media-body">Since <code>*.txt</code> in the current directory expands to <code>notes.txt</code>, the command we actually ran was <code>find . -name notes.txt</code>.  <code>find</code> did what we asked; we just asked for the wrong thing.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/050.png" />
    <p class="media-body">Let's try again, but this time we'll put <code>*.txt</code> in single quotes to prevent the shell from expanding the <code>*</code> wildcard.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/051.png" />
    <p class="media-body">This way, <code>find</code> actually gets the pattern , not the expanded filename <code>notes.txt</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/052.png" />
    <p class="media-body">Sure enough, this time the output is the names of all three text files.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/053.png" />
    <p class="media-body">As we said in previous episodes, the command line's power lies in combining tools.  We've seen how to do that with pipes; let's look at another technique.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/054.png" />
    <p class="media-body">As we just saw, <code>find . -name '*.txt'</code> gives us a list of all text files in or below the current directory.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/055.png" />
    <p class="media-body">Here's how to combine that with <code>wc -l</code> to count the lines in all those files.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/056.png" />
    <p class="media-body">The trick here is to put the <code>find</code> command inside back quotes.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/057.png" />
    <p class="media-body">This tells the shell to run <code>find</code> and then replace what's in the back quotes with the command's output.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/058.png" />
    <p class="media-body">This is exactly what the shell does when it expands <code>*</code>, <code>?</code>, and other built-in wildcards, but more flexible, since we can use any command we want as our own "wildcard".</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/059.png" />
    <p class="media-body">So, when the shell executes this line, the first thing it does is run the command that's inside the back quotes.  Its output is the three filenames <code>./data/first.txt</code>, <code>./data/second.txt</code>, and <code>./notes.txt</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/060.png" />
    <p class="media-body">The shell then replaces the back quotes with that output to construct the command <code>wc -l ./data/first.txt ./data/second.txt ./notes.txt</code>.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/061.png" />
    <p class="media-body">And as you can see, that does what we originally wanted.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/062.png" />
    <p class="media-body">It's very common to use <code>find</code> and <code>grep</code> together.  The first finds files that match a pattern; the second looks for lines inside those files.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/063.png" />
    <p class="media-body">Here, for example, we can find PDB files that contain iron atoms by looking for the string "FE" in all the <code>.pdb</code> files below the current directory.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/064.png" />
    <p class="media-body">So far, we have focused exclusively on finding things in text files.  What if your data isn't text?</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/065.png" />
    <p class="media-body">What if we have images, databases, spreadsheets, or some other format?  There are basically three options.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/066.png" />
    <p class="media-body">The first is to extend tools like <code>grep</code> to handle those formats.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/067.png" />
    <p class="media-body">This hasn't happened, and probably won't, because there are too many formats to support.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/068.png" />
    <p class="media-body">The second option is to convert the data to text, or extract the text-y bits from the data.  This is probably the most common approach, since it only requires people to build one tool per data format (to extract information).</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/069.png" />
    <p class="media-body">On the positive side, this makes simple things easy to do.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/070.png" />
    <p class="media-body">On the negative side, complex things are usually impossible.  For example, it's easy enough to write a program that will extract X and Y dimensions from image files for <code>grep</code> to play with, but how would you write something to find values in a spreadsheet whose cells contained formulas?</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/071.png" />
    <p class="media-body">The third choice is to recognize that the shell and text processing have their limits, and to use a programming language such as Python instead.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/072.png" />
    <p class="media-body">When the time comes to do this, don't be too hard on the shell: many modern programming languages, Python included, have borrowed a lot of ideas from it.</p>
  </div>
  <div class="media">
    <img class="media-object pull-left" src="find/073.png" />
    <p class="media-body">And imitation is also the sincerest form of praise.</p>
  </div>
</div>
